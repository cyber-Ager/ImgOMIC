% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/diameter_correction.R
\name{correct_diameters_all}
\alias{correct_diameters_all}
\title{Correct diameter values across multiple patients}
\usage{
correct_diameters_all(
  data,
  sdUS = 3.5,
  sdCT = 1.9,
  sp = 4,
  dlim_inf = 0,
  dlim_sup = 50
)
}
\arguments{
\item{data}{A data.frame with columns ID, Date, Diam, CT.}

\item{sdUS}{Numeric. SD for Ultrasound measures. Default: 2.}

\item{sdCT}{Numeric. SD for CT measures. Default: 1.}

\item{sp}{Integer. Number of discretization points. Default: 4.}

\item{dlim_inf}{Numeric. Minimum growth rate. Default: 0.}

\item{dlim_sup}{Numeric. Maximum growth rate. Default: 50.}
}
\value{
A data.frame with the same rows as \code{data}, updated \code{Diam}, and
a new \code{corrected} column indicating which values were adjusted.
}
\description{
Applies the single-patient correction to each patient in a dataset.
Converts Date to decimal years if needed, filters out rows with missing
Diam, CT, or Date, and replaces Diam with the most-probable curve (or the
average when multiple curves tie). Adds a logical \code{corrected} flag.
}
\examples{
data <- data.frame(
  ID = factor(c("1","1","2","2")),
  Date = c(2015, 2016, 2015, 2017),
  Diam = c(30, 35, 40, 45),
  CT   = factor(c(1, 0, 1, 0))
)
res_all <- correct_diameters_all(data)
}
