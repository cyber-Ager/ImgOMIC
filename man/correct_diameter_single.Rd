% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/diameter_correction.R
\name{correct_diameter_single}
\alias{correct_diameter_single}
\title{Correct diameter values for a single-patient dataset}
\usage{
correct_diameter_single(
  df_patient,
  sdUS = 3.5,
  sdCT = 1.9,
  sp = 4,
  dlim_sup = 30,
  dlim_inf = 0
)
}
\arguments{
\item{df_patient}{A data.frame with columns:
\itemize{
\item \code{Date}: Numeric time points (e.g., decimal years)
\item \code{Diam}: Measured diameters
\item \code{CT}: Indicator (1=CT, 0=Ultrasound)
}}

\item{sdUS}{Numeric. Standard deviation of Ultrasound diameter measurements.
Default: 2.}

\item{sdCT}{Numeric. Standard deviation of CT-scan diameter measurements.
Default: 1.}

\item{sp}{Integer. Number of discretization points for the error distribution.
Default: 4.}

\item{dlim_sup}{Numeric. Maximum allowable growth rate
\verb{(Diam_t - Diam_\{t-1\}) / (Date_t - Date_\{t-1\})}. Default: 50.}

\item{dlim_inf}{Numeric. Minimum allowable growth rate
\verb{(Diam_t - Diam_\{t-1\}) / (Date_t - Date_\{t-1\})}. Default: 0.}
}
\value{
A list containing:
\itemize{
\item \code{curves}: A list of the most-probable diameter progression vectors.
\item \code{max_prob}: The maximum joint probability among these curves.
\item \code{num_curves}: Number of curves sharing that maximum probability.
}
}
\description{
Adjusts measured artery diameters by accounting for measurement error
based on imaging modality (Ultrasound or CT). It generates multiple
candidate diameters with associated probabilities derived from a normal
distribution of measurement error, then uses a Viterbi-like algorithm to
find all most-probable non-decreasing diameter progression curves.
}
\examples{
data <- data.frame(
  ID = factor(c("1","1","1","1","1","1","1","1","1",
                "2","2","2","2")),
  Date = c(2015, 2016, 2017, 2020, 2021, 2024, 2025, 2026, 2027,
           2013, 2016, 2018, 2019),
  Diam = c(30, 35, 34, 53, 50, 52, 55, 55, 57, 38, 42, 50, 53),
  CT   = factor(c(1,0,0,1,0,0,1,0,1,0,0,0,1))
)
df_patient <- subset(data, ID == "1")
res <- correct_diameter_single(df_patient)
}
